2024-09-17 16:25:07,928 - /Users/noesis/Projects/Group-robust-preference-optimization-bandits/experiments/run_glb_noisy.py[line:198] - INFO: Logging to log_dpo/2024_09_17_16_24_45/swapped_noise1.0_[1,1,1]_2022
2024-09-17 16:25:07,930 - /Users/noesis/Projects/Group-robust-preference-optimization-bandits/experiments/run_glb_noisy.py[line:199] - INFO: (IB) Seed: 2022
2024-09-17 16:25:07,931 - /Users/noesis/Projects/Group-robust-preference-optimization-bandits/experiments/run_glb_noisy.py[line:200] - INFO: (IB) Data: 300
2024-09-17 16:25:08,093 - /Users/noesis/Projects/Group-robust-preference-optimization-bandits/experiments/run_glb_noisy.py[line:296] - INFO: MLE reward loss: 0.3316, l2 distance: 39.4446, acc: 0.83.
2024-09-17 16:25:08,093 - /Users/noesis/Projects/Group-robust-preference-optimization-bandits/experiments/run_glb_noisy.py[line:297] - INFO: True reward parameter: [[1.  3.  1.  3. ]
 [3.  1.  3.  1. ]
 [1.5 2.5 1.5 2.5]]
2024-09-17 16:25:08,094 - /Users/noesis/Projects/Group-robust-preference-optimization-bandits/experiments/run_glb_noisy.py[line:298] - INFO: MLE reward parameter: [16.35863729  9.16281242 16.84987109  7.67203992]
2024-09-17 16:25:08,298 - /Users/noesis/Projects/Group-robust-preference-optimization-bandits/experiments/run_glb_noisy.py[line:313] - INFO: Learned oracle reward: 3.6080, 3.8501, 3.2158
2024-09-17 16:25:09,616 - /Users/noesis/Projects/Group-robust-preference-optimization-bandits/algos/linear_bandit/group_dpo_vectorised.py[line:947] - INFO: Iteration:  0, train_loss:  19.5405, val_loss:  19.3567, grad_norm: 0.7718, reward_err: 0.0827, 0.0183, 0.0490, KL_dist: 0.2890, 0.0513, 0.1768, param: [4.565038   2.56255758 3.06501675 0.98001647]train_grp_loss: [22.83835708 14.35579214 21.53828818], val_grp_loss: [22.88349092 13.95410493 21.56053381], train_hist_grp_loss: [22.86759488 14.46155466 21.58044446], cur_train_grp_loss: [22.86759488 14.46155466 21.58044446],max_reward_err:  0.0827, max_reward_err_index: 0, max_kl_dist:  0.2890, max_kl_dist_index: 0, max_train_grp_loss:  22.8384, max_train_grp_loss_index: 0, max_val_grp_loss:  22.8835, max_val_grp_loss_index: 0, max_cur_train_grp_loss:  22.8676, max_cur_train_grp_loss_index: 0, 
2024-09-17 16:25:12,743 - /Users/noesis/Projects/Group-robust-preference-optimization-bandits/algos/linear_bandit/group_dpo_vectorised.py[line:1040] - INFO: Iteration:  99, train_loss:  16.0067, val_loss:  15.8016, grad_norm: 0.4456, reward_err: 0.0712, 0.0041, 0.0368, KL_dist: 0.8736, 0.3954, 0.6724, param: [8.04909748 3.88935075 7.02652686 3.12418776]train_grp_loss: [20.97086328  8.55794493 18.66158572], val_grp_loss: [21.24337608  7.91708693 18.70627875], train_hist_grp_loss: [2178.14994628 1090.32939322 1994.64427019], cur_train_grp_loss: [20.98234177  8.58614242 18.68097937],max_reward_err:  0.0712, max_reward_err_index: 0, max_kl_dist:  0.8736, max_kl_dist_index: 0, max_train_grp_loss:  20.9709, max_train_grp_loss_index: 0, max_val_grp_loss:  21.2434, max_val_grp_loss_index: 0, max_cur_train_grp_loss:  20.9823, max_cur_train_grp_loss_index: 0, 
2024-09-17 16:25:12,973 - /Users/noesis/Projects/Group-robust-preference-optimization-bandits/experiments/run_glb_noisy.py[line:386] - INFO: Policy parameter learned solely on the preference data dpo: [8.04909748 3.88935075 7.02652686 3.12418776].
2024-09-17 16:25:13,299 - /Users/noesis/Projects/Group-robust-preference-optimization-bandits/experiments/run_glb_noisy.py[line:397] - INFO: Uniform reward: 3.8395, 3.8395, 3.1958
2024-09-17 16:25:13,300 - /Users/noesis/Projects/Group-robust-preference-optimization-bandits/experiments/run_glb_noisy.py[line:398] - INFO: Optimal reward: 3.8707, 3.8707, 3.3276
2024-09-17 16:25:13,301 - /Users/noesis/Projects/Group-robust-preference-optimization-bandits/experiments/run_glb_noisy.py[line:399] - INFO: Policy reward: 3.5953, 3.8548, 3.2050
2024-09-17 16:25:13,301 - /Users/noesis/Projects/Group-robust-preference-optimization-bandits/experiments/run_glb_noisy.py[line:400] - INFO: Reward Error: 0.0712, 0.0041, 0.0368
2024-09-17 16:25:13,982 - /Users/noesis/Projects/Group-robust-preference-optimization-bandits/experiments/run_glb_noisy.py[line:415] - INFO: Optimal reward: 3.8707, 3.8707, 3.3276
Known param reward: [[3.870737075805664, 3.5440561771392822, 3.277423858642578], [3.5440561771392822, 3.870737075805664, 3.1691665649414062], [3.8269641399383545, 3.639406681060791, 3.327569007873535]], Known param reward error: [[0.0, 0.08439759463599984, 0.015069604600928176], [0.08439759463599984, 0.0, 0.04760305272627693], [0.011308682302633167, 0.059763913232655674, 0.0]].
