2024-09-17 16:45:58,644 - /Users/noesis/Projects/Group-robust-preference-optimization-bandits/experiments/run_glb_noisy.py[line:198] - INFO: Logging to log_dpo/2024_09_17_16_43_07/swapped_noise0.9_[1,1,1]_2030
2024-09-17 16:45:58,646 - /Users/noesis/Projects/Group-robust-preference-optimization-bandits/experiments/run_glb_noisy.py[line:199] - INFO: (IB) Seed: 2030
2024-09-17 16:45:58,647 - /Users/noesis/Projects/Group-robust-preference-optimization-bandits/experiments/run_glb_noisy.py[line:200] - INFO: (IB) Data: 300
2024-09-17 16:45:58,804 - /Users/noesis/Projects/Group-robust-preference-optimization-bandits/experiments/run_glb_noisy.py[line:296] - INFO: MLE reward loss: 0.3479, l2 distance: 35.0581, acc: 0.82.
2024-09-17 16:45:58,805 - /Users/noesis/Projects/Group-robust-preference-optimization-bandits/experiments/run_glb_noisy.py[line:297] - INFO: True reward parameter: [[1.  3.  1.  3. ]
 [3.  1.  3.  1. ]
 [1.5 2.5 1.5 2.5]]
2024-09-17 16:45:58,806 - /Users/noesis/Projects/Group-robust-preference-optimization-bandits/experiments/run_glb_noisy.py[line:298] - INFO: MLE reward parameter: [15.05760198  9.02088505 13.91934012  8.40113114]
2024-09-17 16:45:59,005 - /Users/noesis/Projects/Group-robust-preference-optimization-bandits/experiments/run_glb_noisy.py[line:313] - INFO: Learned oracle reward: 3.6171, 3.8399, 3.2835
2024-09-17 16:46:00,277 - /Users/noesis/Projects/Group-robust-preference-optimization-bandits/algos/linear_bandit/group_dpo_vectorised.py[line:947] - INFO: Iteration:  0, train_loss:  22.6901, val_loss:  23.0612, grad_norm: 1.0208, reward_err: 0.0168, 0.0808, 0.0042, KL_dist: 0.0562, 0.1114, 0.0366, param: [0.66485461 1.98215759 1.1550554  0.84674587]train_grp_loss: [23.70198343 20.85389637 23.68617896], val_grp_loss: [23.56798617 22.00455334 23.50117486], train_hist_grp_loss: [23.74634715 21.06094747 23.73634611], cur_train_grp_loss: [23.74634715 21.06094747 23.73634611],max_reward_err:  0.0808, max_reward_err_index: 1, max_kl_dist:  0.1114, max_kl_dist_index: 1, max_train_grp_loss:  23.7020, max_train_grp_loss_index: 0, max_val_grp_loss:  23.5680, max_val_grp_loss_index: 0, max_cur_train_grp_loss:  23.7463, max_cur_train_grp_loss_index: 0, 
2024-09-17 16:46:03,253 - /Users/noesis/Projects/Group-robust-preference-optimization-bandits/algos/linear_bandit/group_dpo_vectorised.py[line:1040] - INFO: Iteration:  99, train_loss:  16.8582, val_loss:  17.5435, grad_norm: 0.5491, reward_err: 0.0726, 0.0119, 0.0340, KL_dist: 0.5923, 0.2516, 0.4222, param: [5.71025913 3.99634008 5.90885552 2.83606823]train_grp_loss: [21.0093541   9.74319851 20.52245587], val_grp_loss: [20.9120179  11.18605095 19.84427483], train_hist_grp_loss: [2215.29605744 1420.06226547 2188.96939931], cur_train_grp_loss: [21.02481659  9.79621881 20.54169515],max_reward_err:  0.0726, max_reward_err_index: 0, max_kl_dist:  0.5923, max_kl_dist_index: 0, max_train_grp_loss:  21.0094, max_train_grp_loss_index: 0, max_val_grp_loss:  20.9120, max_val_grp_loss_index: 0, max_cur_train_grp_loss:  21.0248, max_cur_train_grp_loss_index: 0, 
2024-09-17 16:46:03,479 - /Users/noesis/Projects/Group-robust-preference-optimization-bandits/experiments/run_glb_noisy.py[line:386] - INFO: Policy parameter learned solely on the preference data dpo: [5.71025913 3.99634008 5.90885552 2.83606823].
2024-09-17 16:46:03,796 - /Users/noesis/Projects/Group-robust-preference-optimization-bandits/experiments/run_glb_noisy.py[line:397] - INFO: Uniform reward: 3.8379, 3.8379, 3.2305
2024-09-17 16:46:03,797 - /Users/noesis/Projects/Group-robust-preference-optimization-bandits/experiments/run_glb_noisy.py[line:398] - INFO: Optimal reward: 3.8816, 3.8816, 3.3879
2024-09-17 16:46:03,798 - /Users/noesis/Projects/Group-robust-preference-optimization-bandits/experiments/run_glb_noisy.py[line:399] - INFO: Policy reward: 3.5999, 3.8354, 3.2727
2024-09-17 16:46:03,798 - /Users/noesis/Projects/Group-robust-preference-optimization-bandits/experiments/run_glb_noisy.py[line:400] - INFO: Reward Error: 0.0726, 0.0119, 0.0340
2024-09-17 16:46:04,455 - /Users/noesis/Projects/Group-robust-preference-optimization-bandits/experiments/run_glb_noisy.py[line:415] - INFO: Optimal reward: 3.8816, 3.8816, 3.3879
Known param reward: [[3.881588935852051, 3.493168592453003, 3.3462095260620117], [3.493168592453003, 3.881588935852051, 3.1958134174346924], [3.8417856693267822, 3.59991455078125, 3.3879454135894775]], Known param reward error: [[0.0, 0.10006735638888185, 0.012318937418548096], [0.10006735638888185, 0.0, 0.05671047573084248], [0.01025437447990131, 0.07256677348524289, 0.0]].
