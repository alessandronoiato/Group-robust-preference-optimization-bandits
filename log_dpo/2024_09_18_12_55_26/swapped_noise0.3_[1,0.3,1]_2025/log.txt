2024-09-18 13:36:28,297 - /Users/noesis/Projects/Group-robust-preference-optimization-bandits/experiments/run_glb_noisy.py[line:199] - INFO: Logging to log_dpo/2024_09_18_12_55_26/swapped_noise0.3_[1,0.3,1]_2025
2024-09-18 13:36:28,298 - /Users/noesis/Projects/Group-robust-preference-optimization-bandits/experiments/run_glb_noisy.py[line:200] - INFO: (IB) Seed: 2025
2024-09-18 13:36:28,299 - /Users/noesis/Projects/Group-robust-preference-optimization-bandits/experiments/run_glb_noisy.py[line:201] - INFO: (IB) Data: 300
2024-09-18 13:36:28,465 - /Users/noesis/Projects/Group-robust-preference-optimization-bandits/experiments/run_glb_noisy.py[line:297] - INFO: MLE reward loss: 0.4481, l2 distance: 16.8481, acc: 0.80.
2024-09-18 13:36:28,466 - /Users/noesis/Projects/Group-robust-preference-optimization-bandits/experiments/run_glb_noisy.py[line:298] - INFO: True reward parameter: [[1.  3.  1.  3. ]
 [3.  1.  3.  1. ]
 [1.5 2.5 1.5 2.5]]
2024-09-18 13:36:28,467 - /Users/noesis/Projects/Group-robust-preference-optimization-bandits/experiments/run_glb_noisy.py[line:299] - INFO: MLE reward parameter: [8.49886496 5.08483761 7.57654104 4.57522525]
2024-09-18 13:36:28,671 - /Users/noesis/Projects/Group-robust-preference-optimization-bandits/experiments/run_glb_noisy.py[line:314] - INFO: Learned oracle reward: 3.5973, 3.8110, 3.1540
2024-09-18 13:36:29,967 - /Users/noesis/Projects/Group-robust-preference-optimization-bandits/algos/linear_bandit/group_dpo_vectorised.py[line:947] - INFO: Iteration:  0, train_loss:  20.5586, val_loss:  21.5410, grad_norm: 0.8005, reward_err: 0.0561, 0.0659, 0.0242, KL_dist: 0.1385, 0.1437, 0.0665, param: [3.01145288 0.30028509 2.82453678 3.80736834]train_grp_loss: [22.86041025 17.41463916 21.97318444], val_grp_loss: [22.76934142 19.72441131 22.18345082], train_hist_grp_loss: [22.88681882 17.52915112 22.01457343], cur_train_grp_loss: [22.88681882 17.52915112 22.01457343],max_reward_err:  0.0659, max_reward_err_index: 1, max_kl_dist:  0.1437, max_kl_dist_index: 1, max_train_grp_loss:  22.8604, max_train_grp_loss_index: 0, max_val_grp_loss:  22.7693, max_val_grp_loss_index: 0, max_cur_train_grp_loss:  22.8868, max_cur_train_grp_loss_index: 0, 
2024-09-18 13:36:33,164 - /Users/noesis/Projects/Group-robust-preference-optimization-bandits/algos/linear_bandit/group_dpo_vectorised.py[line:1040] - INFO: Iteration:  99, train_loss:  17.1987, val_loss:  19.2296, grad_norm: 0.3977, reward_err: 0.0704, 0.0077, 0.0351, KL_dist: 0.6309, 0.3074, 0.4740, param: [6.72702411 2.9055485  6.19395882 4.10403022]train_grp_loss: [21.35997195 11.87505948 19.34405545], val_grp_loss: [21.40903432 16.62127752 19.75848772], train_hist_grp_loss: [2197.72420571 1398.25111934 2048.44428003], cur_train_grp_loss: [21.36769132 11.89710028 19.36025295],max_reward_err:  0.0704, max_reward_err_index: 0, max_kl_dist:  0.6309, max_kl_dist_index: 0, max_train_grp_loss:  21.3600, max_train_grp_loss_index: 0, max_val_grp_loss:  21.4090, max_val_grp_loss_index: 0, max_cur_train_grp_loss:  21.3677, max_cur_train_grp_loss_index: 0, 
2024-09-18 13:36:33,389 - /Users/noesis/Projects/Group-robust-preference-optimization-bandits/experiments/run_glb_noisy.py[line:387] - INFO: Policy parameter learned solely on the preference data dpo: [6.72702411 2.9055485  6.19395882 4.10403022].
2024-09-18 13:36:33,717 - /Users/noesis/Projects/Group-robust-preference-optimization-bandits/experiments/run_glb_noisy.py[line:398] - INFO: Uniform reward: 3.8189, 3.8189, 3.1471
2024-09-18 13:36:33,717 - /Users/noesis/Projects/Group-robust-preference-optimization-bandits/experiments/run_glb_noisy.py[line:399] - INFO: Optimal reward: 3.8509, 3.8509, 3.2572
2024-09-18 13:36:33,718 - /Users/noesis/Projects/Group-robust-preference-optimization-bandits/experiments/run_glb_noisy.py[line:400] - INFO: Policy reward: 3.5797, 3.8210, 3.1429
2024-09-18 13:36:33,718 - /Users/noesis/Projects/Group-robust-preference-optimization-bandits/experiments/run_glb_noisy.py[line:401] - INFO: Reward Error: 0.0704, 0.0077, 0.0351
2024-09-18 13:36:34,401 - /Users/noesis/Projects/Group-robust-preference-optimization-bandits/experiments/run_glb_noisy.py[line:416] - INFO: Optimal reward: 3.8509, 3.8509, 3.2572
Known param reward: [[3.850886821746826, 3.4759232997894287, 3.2200934886932373], [3.4759232997894287, 3.850886821746826, 3.068084716796875], [3.8119678497314453, 3.597700595855713, 3.257154703140259]], Known param reward error: [[0.0, 0.09737069389832334, 0.011378401649541042], [0.09737069389832334, 0.0, 0.058047591709751864], [0.010106495936363709, 0.06574751157611633, 0.0]].
