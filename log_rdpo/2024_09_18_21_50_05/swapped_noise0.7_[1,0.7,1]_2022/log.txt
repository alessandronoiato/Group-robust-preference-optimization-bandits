2024-09-18 22:16:19,978 - /Users/noesis/Projects/Group-robust-preference-optimization-bandits/experiments/run_glb_noisy.py[line:199] - INFO: Logging to log_rdpo/2024_09_18_21_50_05/swapped_noise0.7_[1,0.7,1]_2022
2024-09-18 22:16:19,980 - /Users/noesis/Projects/Group-robust-preference-optimization-bandits/experiments/run_glb_noisy.py[line:200] - INFO: (IB) Seed: 2022
2024-09-18 22:16:19,980 - /Users/noesis/Projects/Group-robust-preference-optimization-bandits/experiments/run_glb_noisy.py[line:201] - INFO: (IB) Data: 300
2024-09-18 22:16:20,143 - /Users/noesis/Projects/Group-robust-preference-optimization-bandits/experiments/run_glb_noisy.py[line:297] - INFO: MLE reward loss: 0.4860, l2 distance: 13.4347, acc: 0.77.
2024-09-18 22:16:20,144 - /Users/noesis/Projects/Group-robust-preference-optimization-bandits/experiments/run_glb_noisy.py[line:298] - INFO: True reward parameter: [[1.  3.  1.  3. ]
 [3.  1.  3.  1. ]
 [1.5 2.5 1.5 2.5]]
2024-09-18 22:16:20,145 - /Users/noesis/Projects/Group-robust-preference-optimization-bandits/experiments/run_glb_noisy.py[line:299] - INFO: MLE reward parameter: [6.72509148 2.81764665 7.31992199 3.84579016]
2024-09-18 22:16:20,356 - /Users/noesis/Projects/Group-robust-preference-optimization-bandits/experiments/run_glb_noisy.py[line:314] - INFO: Learned oracle reward: 3.5185, 3.8475, 3.1578
2024-09-18 22:16:20,605 - /Users/noesis/Projects/Group-robust-preference-optimization-bandits/algos/linear_bandit/group_robust_dpo_vectorised_gradfix.py[line:1297] - INFO: unique_group_ids: {0, 1, 2}
2024-09-18 22:16:21,902 - /Users/noesis/Projects/Group-robust-preference-optimization-bandits/algos/linear_bandit/group_robust_dpo_vectorised_gradfix.py[line:1523] - INFO: Iteration:  0, train_loss:  16.9518, val_loss:  14.0881, grad_norm: 0.2310, live_grad: 0.0000, reward_err: 0.0964, 0.0011, 0.0548, KL_dist: 1.5027, 0.7619, 1.2005, param: [ 9.67852176  3.26394908 10.92240132  4.86010691], weights: [0.33303609 0.33295587 0.33400804], train_wt_loss:  50.8554, val_wt_loss: 42.2644, train_grp_loss: [20.41138739 12.75071963 19.35493406], val_grp_loss: [19.15447875  5.69957835 18.04159005], train_hist_grp_loss: [0.17627665 0.15218739 0.46769648], cur_train_grp_loss: [0.17627665 0.15218739 0.46769648], max_reward_err:  0.0964, max_reward_err_index: 0, max_kl_dist:  1.5027, max_kl_dist_index: 0, max_train_grp_loss:  20.4114, max_train_grp_loss_index: 0, max_val_grp_loss:  19.1545, max_val_grp_loss_index: 0, max_cur_train_grp_loss:  0.4677, max_cur_train_grp_loss_index: 2, 
2024-09-18 22:16:26,356 - /Users/noesis/Projects/Group-robust-preference-optimization-bandits/algos/linear_bandit/group_robust_dpo_vectorised_gradfix.py[line:1631] - INFO: Iteration:  99, train_loss:  16.9586, val_loss:  14.0281, grad_norm: 0.0158,  live_grad: 0.0000, reward_err: 0.0940, 0.0014, 0.0526, KL_dist: 1.5122, 0.7853, 1.2126, param: [ 9.78666373  3.48689243 10.97170045  5.09313434], weights: [0.31077665 0.29152917 0.39769419], train_wt_loss:  50.8757, val_wt_loss: 42.0844, train_grp_loss: [20.25434995 12.97643508 19.19304228], val_grp_loss: [18.98721833  5.83446904 17.87978302], train_hist_grp_loss: [16.4122339  10.0187925  41.07312071], cur_train_grp_loss: [0.16335546 0.10057191 0.4084007 ], max_reward_err:  0.0940, max_reward_err_index: 0, max_kl_dist:  1.5122, max_kl_dist_index: 0, max_train_grp_loss:  20.2543, max_train_grp_loss_index: 0, max_val_grp_loss:  18.9872, max_val_grp_loss_index: 0, max_cur_train_grp_loss:  0.4084, max_cur_train_grp_loss_index: 2, 
2024-09-18 22:16:26,579 - /Users/noesis/Projects/Group-robust-preference-optimization-bandits/experiments/run_glb_noisy.py[line:387] - INFO: Policy parameter learned solely on the preference data rdpo: [ 9.78666373  3.48689243 10.97170045  5.09313434].
2024-09-18 22:16:26,912 - /Users/noesis/Projects/Group-robust-preference-optimization-bandits/experiments/run_glb_noisy.py[line:398] - INFO: Uniform reward: 3.8288, 3.8288, 3.1923
2024-09-18 22:16:26,912 - /Users/noesis/Projects/Group-robust-preference-optimization-bandits/experiments/run_glb_noisy.py[line:399] - INFO: Optimal reward: 3.8608, 3.8608, 3.3174
2024-09-18 22:16:26,913 - /Users/noesis/Projects/Group-robust-preference-optimization-bandits/experiments/run_glb_noisy.py[line:400] - INFO: Policy reward: 3.4979, 3.8553, 3.1428
2024-09-18 22:16:26,913 - /Users/noesis/Projects/Group-robust-preference-optimization-bandits/experiments/run_glb_noisy.py[line:401] - INFO: Reward Error: 0.0940, 0.0014, 0.0526
2024-09-18 22:16:27,593 - /Users/noesis/Projects/Group-robust-preference-optimization-bandits/experiments/run_glb_noisy.py[line:416] - INFO: Optimal reward: 3.8608, 3.8608, 3.3174
Known param reward: [[3.8608431816101074, 3.4672656059265137, 3.286299705505371], [3.4672656059265137, 3.8608431816101074, 3.1212518215179443], [3.8267719745635986, 3.5796079635620117, 3.3174452781677246]], Known param reward error: [[0.0, 0.10194083446804438, 0.009388420923571552], [0.10194083446804438, 0.0, 0.05913992250028639], [0.008824809878006984, 0.07284295290408836, 0.0]].
