2024-09-18 20:39:49,355 - /Users/noesis/Projects/Group-robust-preference-optimization-bandits/experiments/run_glb_noisy.py[line:199] - INFO: Logging to log_rdpo/2024_09_18_20_28_18/swapped_noise0.5_[1,0.5,1]_2025
2024-09-18 20:39:49,357 - /Users/noesis/Projects/Group-robust-preference-optimization-bandits/experiments/run_glb_noisy.py[line:200] - INFO: (IB) Seed: 2025
2024-09-18 20:39:49,357 - /Users/noesis/Projects/Group-robust-preference-optimization-bandits/experiments/run_glb_noisy.py[line:201] - INFO: (IB) Data: 300
2024-09-18 20:39:49,523 - /Users/noesis/Projects/Group-robust-preference-optimization-bandits/experiments/run_glb_noisy.py[line:297] - INFO: MLE reward loss: 0.4543, l2 distance: 16.6174, acc: 0.81.
2024-09-18 20:39:49,524 - /Users/noesis/Projects/Group-robust-preference-optimization-bandits/experiments/run_glb_noisy.py[line:298] - INFO: True reward parameter: [[1.  3.  1.  3. ]
 [3.  1.  3.  1. ]
 [1.5 2.5 1.5 2.5]]
2024-09-18 20:39:49,525 - /Users/noesis/Projects/Group-robust-preference-optimization-bandits/experiments/run_glb_noisy.py[line:299] - INFO: MLE reward parameter: [8.68775344 5.26920364 6.98565022 4.61655316]
2024-09-18 20:39:49,731 - /Users/noesis/Projects/Group-robust-preference-optimization-bandits/experiments/run_glb_noisy.py[line:314] - INFO: Learned oracle reward: 3.5914, 3.7958, 3.1513
2024-09-18 20:39:49,985 - /Users/noesis/Projects/Group-robust-preference-optimization-bandits/algos/linear_bandit/group_robust_dpo_vectorised_gradfix.py[line:1297] - INFO: unique_group_ids: {0, 1, 2}
2024-09-18 20:39:51,345 - /Users/noesis/Projects/Group-robust-preference-optimization-bandits/algos/linear_bandit/group_robust_dpo_vectorised_gradfix.py[line:1523] - INFO: Iteration:  0, train_loss:  16.1995, val_loss:  16.8341, grad_norm: 0.2312, live_grad: 0.0000, reward_err: 0.0907, 0.0049, 0.0538, KL_dist: 1.4817, 0.8657, 1.2254, param: [12.13299074  5.48600537  8.64469861  4.33328784], weights: [0.33309678 0.33292913 0.33397409], train_wt_loss:  48.5985, val_wt_loss: 50.5022, train_grp_loss: [19.39116254 12.73621185 17.32834823], val_grp_loss: [19.9817424  13.17360992 17.36876481], train_hist_grp_loss: [0.17813939 0.12779824 0.44117496], cur_train_grp_loss: [0.17813939 0.12779824 0.44117496], max_reward_err:  0.0907, max_reward_err_index: 0, max_kl_dist:  1.4817, max_kl_dist_index: 0, max_train_grp_loss:  19.3912, max_train_grp_loss_index: 0, max_val_grp_loss:  19.9817, max_val_grp_loss_index: 0, max_cur_train_grp_loss:  0.4412, max_cur_train_grp_loss_index: 2, 
2024-09-18 20:39:55,886 - /Users/noesis/Projects/Group-robust-preference-optimization-bandits/algos/linear_bandit/group_robust_dpo_vectorised_gradfix.py[line:1631] - INFO: Iteration:  99, train_loss:  16.2060, val_loss:  16.8507, grad_norm: 0.0133,  live_grad: 0.0000, reward_err: 0.0893, 0.0056, 0.0526, KL_dist: 1.5036, 0.8979, 1.2498, param: [12.28458186  5.72291478  8.67954212  4.59298406], weights: [0.31553718 0.29798637 0.38647645], train_wt_loss:  48.6181, val_wt_loss: 50.5521, train_grp_loss: [19.2147917  12.98845733 17.14338016], val_grp_loss: [19.80917903 13.57103343 17.19440999], train_hist_grp_loss: [15.71684513  9.99397013 35.99628861], cur_train_grp_loss: [0.15623319 0.10066347 0.35719527], max_reward_err:  0.0893, max_reward_err_index: 0, max_kl_dist:  1.5036, max_kl_dist_index: 0, max_train_grp_loss:  19.2148, max_train_grp_loss_index: 0, max_val_grp_loss:  19.8092, max_val_grp_loss_index: 0, max_cur_train_grp_loss:  0.3572, max_cur_train_grp_loss_index: 2, 
2024-09-18 20:39:56,111 - /Users/noesis/Projects/Group-robust-preference-optimization-bandits/experiments/run_glb_noisy.py[line:387] - INFO: Policy parameter learned solely on the preference data rdpo: [12.28458186  5.72291478  8.67954212  4.59298406].
2024-09-18 20:39:56,448 - /Users/noesis/Projects/Group-robust-preference-optimization-bandits/experiments/run_glb_noisy.py[line:398] - INFO: Uniform reward: 3.8103, 3.8103, 3.1427
2024-09-18 20:39:56,448 - /Users/noesis/Projects/Group-robust-preference-optimization-bandits/experiments/run_glb_noisy.py[line:399] - INFO: Optimal reward: 3.8440, 3.8440, 3.2545
2024-09-18 20:39:56,449 - /Users/noesis/Projects/Group-robust-preference-optimization-bandits/experiments/run_glb_noisy.py[line:400] - INFO: Policy reward: 3.5008, 3.8223, 3.0834
2024-09-18 20:39:56,449 - /Users/noesis/Projects/Group-robust-preference-optimization-bandits/experiments/run_glb_noisy.py[line:401] - INFO: Reward Error: 0.0893, 0.0056, 0.0526
2024-09-18 20:39:57,147 - /Users/noesis/Projects/Group-robust-preference-optimization-bandits/experiments/run_glb_noisy.py[line:416] - INFO: Optimal reward: 3.8440, 3.8440, 3.2545
Known param reward: [[3.843956232070923, 3.4647014141082764, 3.2180964946746826], [3.4647014141082764, 3.843956232070923, 3.0630156993865967], [3.8041796684265137, 3.590562105178833, 3.254488229751587]], Known param reward error: [[0.0, 0.09866262648841967, 0.011182014654169469], [0.09866262648841967, 0.0, 0.058833376201703216], [0.010347819080910722, 0.06592013841832281, 0.0]].
