2024-09-18 20:45:27,583 - /Users/noesis/Projects/Group-robust-preference-optimization-bandits/experiments/run_glb_noisy.py[line:199] - INFO: Logging to log_rdpo/2024_09_18_20_28_18/swapped_noise0.3_[1,0.3,1]_2021
2024-09-18 20:45:27,585 - /Users/noesis/Projects/Group-robust-preference-optimization-bandits/experiments/run_glb_noisy.py[line:200] - INFO: (IB) Seed: 2021
2024-09-18 20:45:27,586 - /Users/noesis/Projects/Group-robust-preference-optimization-bandits/experiments/run_glb_noisy.py[line:201] - INFO: (IB) Data: 300
2024-09-18 20:45:27,754 - /Users/noesis/Projects/Group-robust-preference-optimization-bandits/experiments/run_glb_noisy.py[line:297] - INFO: MLE reward loss: 0.5327, l2 distance: 9.2150, acc: 0.78.
2024-09-18 20:45:27,755 - /Users/noesis/Projects/Group-robust-preference-optimization-bandits/experiments/run_glb_noisy.py[line:298] - INFO: True reward parameter: [[1.  3.  1.  3. ]
 [3.  1.  3.  1. ]
 [1.5 2.5 1.5 2.5]]
2024-09-18 20:45:27,756 - /Users/noesis/Projects/Group-robust-preference-optimization-bandits/experiments/run_glb_noisy.py[line:299] - INFO: MLE reward parameter: [6.10968104 2.29424698 4.49928353 2.24249985]
2024-09-18 20:45:27,966 - /Users/noesis/Projects/Group-robust-preference-optimization-bandits/experiments/run_glb_noisy.py[line:314] - INFO: Learned oracle reward: 3.4996, 3.8765, 3.1218
2024-09-18 20:45:28,204 - /Users/noesis/Projects/Group-robust-preference-optimization-bandits/algos/linear_bandit/group_robust_dpo_vectorised_gradfix.py[line:1297] - INFO: unique_group_ids: {0, 1, 2}
2024-09-18 20:45:29,526 - /Users/noesis/Projects/Group-robust-preference-optimization-bandits/algos/linear_bandit/group_robust_dpo_vectorised_gradfix.py[line:1523] - INFO: Iteration:  0, train_loss:  18.3131, val_loss:  18.1011, grad_norm: 0.1847, live_grad: 0.0000, reward_err: 0.1076, 0.0007, 0.0661, KL_dist: 1.2708, 0.5824, 1.0181, param: [10.87761519  3.44839184  7.39118805  3.47172269], weights: [0.33305924 0.33302287 0.33391789], train_wt_loss:  54.9393, val_wt_loss: 54.3032, train_grp_loss: [20.55039937 15.73170812 19.17331001], val_grp_loss: [19.72803464 16.45682741 18.200497  ], train_hist_grp_loss: [0.17212325 0.16120487 0.42960076], cur_train_grp_loss: [0.17212325 0.16120487 0.42960076], max_reward_err:  0.1076, max_reward_err_index: 0, max_kl_dist:  1.2708, max_kl_dist_index: 0, max_train_grp_loss:  20.5504, max_train_grp_loss_index: 0, max_val_grp_loss:  19.7280, max_val_grp_loss_index: 0, max_cur_train_grp_loss:  0.4296, max_cur_train_grp_loss_index: 2, 
2024-09-18 20:45:34,050 - /Users/noesis/Projects/Group-robust-preference-optimization-bandits/algos/linear_bandit/group_robust_dpo_vectorised_gradfix.py[line:1631] - INFO: Iteration:  99, train_loss:  18.3170, val_loss:  18.0766, grad_norm: 0.0113,  live_grad: 0.0000, reward_err: 0.1043, 0.0007, 0.0629, KL_dist: 1.2755, 0.6024, 1.0229, param: [10.85139288  3.59523288  7.62142449  3.62841848], weights: [0.31173718 0.30034214 0.38792068], train_wt_loss:  54.9511, val_wt_loss: 54.2297, train_grp_loss: [20.44386233 15.89871409 19.04585315], val_grp_loss: [19.60892023 16.61709458 18.07420565], train_hist_grp_loss: [16.40720097 12.68338262 38.27124446], cur_train_grp_loss: [0.16356008 0.12717443 0.38094491], max_reward_err:  0.1043, max_reward_err_index: 0, max_kl_dist:  1.2755, max_kl_dist_index: 0, max_train_grp_loss:  20.4439, max_train_grp_loss_index: 0, max_val_grp_loss:  19.6089, max_val_grp_loss_index: 0, max_cur_train_grp_loss:  0.3809, max_cur_train_grp_loss_index: 2, 
2024-09-18 20:45:34,278 - /Users/noesis/Projects/Group-robust-preference-optimization-bandits/experiments/run_glb_noisy.py[line:387] - INFO: Policy parameter learned solely on the preference data rdpo: [10.85139288  3.59523288  7.62142449  3.62841848].
2024-09-18 20:45:34,621 - /Users/noesis/Projects/Group-robust-preference-optimization-bandits/experiments/run_glb_noisy.py[line:398] - INFO: Uniform reward: 3.8449, 3.8449, 3.1975
2024-09-18 20:45:34,622 - /Users/noesis/Projects/Group-robust-preference-optimization-bandits/experiments/run_glb_noisy.py[line:399] - INFO: Optimal reward: 3.8804, 3.8804, 3.3109
2024-09-18 20:45:34,623 - /Users/noesis/Projects/Group-robust-preference-optimization-bandits/experiments/run_glb_noisy.py[line:400] - INFO: Policy reward: 3.4758, 3.8775, 3.1026
2024-09-18 20:45:34,623 - /Users/noesis/Projects/Group-robust-preference-optimization-bandits/experiments/run_glb_noisy.py[line:401] - INFO: Reward Error: 0.1043, 0.0007, 0.0629
2024-09-18 20:45:35,326 - /Users/noesis/Projects/Group-robust-preference-optimization-bandits/experiments/run_glb_noisy.py[line:416] - INFO: Optimal reward: 3.8804, 3.8804, 3.3109
Known param reward: [[3.880363702774048, 3.454080104827881, 3.2871222496032715], [3.454080104827881, 3.880363702774048, 3.0933778285980225], [3.845717430114746, 3.5881128311157227, 3.310894012451172]], Known param reward error: [[0.0, 0.10985660896720055, 0.0071798622240708074], [0.10985660896720055, 0.0, 0.0656971147476009], [0.008928614767356305, 0.07531532970721194, 0.0]].
