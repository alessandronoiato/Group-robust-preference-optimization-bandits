2024-09-18 22:54:38,912 - /Users/noesis/Projects/Group-robust-preference-optimization-bandits/experiments/run_glb_noisy.py[line:199] - INFO: Logging to log_rdpo/2024_09_18_22_39_43/swapped_noise0.4_[1,0.4,1]_2021
2024-09-18 22:54:38,914 - /Users/noesis/Projects/Group-robust-preference-optimization-bandits/experiments/run_glb_noisy.py[line:200] - INFO: (IB) Seed: 2021
2024-09-18 22:54:38,914 - /Users/noesis/Projects/Group-robust-preference-optimization-bandits/experiments/run_glb_noisy.py[line:201] - INFO: (IB) Data: 300
2024-09-18 22:54:39,076 - /Users/noesis/Projects/Group-robust-preference-optimization-bandits/experiments/run_glb_noisy.py[line:297] - INFO: MLE reward loss: 0.4956, l2 distance: 15.3300, acc: 0.80.
2024-09-18 22:54:39,077 - /Users/noesis/Projects/Group-robust-preference-optimization-bandits/experiments/run_glb_noisy.py[line:298] - INFO: True reward parameter: [[1.  3.  1.  3. ]
 [3.  1.  3.  1. ]
 [1.5 2.5 1.5 2.5]]
2024-09-18 22:54:39,078 - /Users/noesis/Projects/Group-robust-preference-optimization-bandits/experiments/run_glb_noisy.py[line:299] - INFO: MLE reward parameter: [10.44868047  2.086339    1.4557587   3.20313765]
2024-09-18 22:54:39,285 - /Users/noesis/Projects/Group-robust-preference-optimization-bandits/experiments/run_glb_noisy.py[line:314] - INFO: Learned oracle reward: 3.3324, 3.8143, 2.9690
2024-09-18 22:54:39,540 - /Users/noesis/Projects/Group-robust-preference-optimization-bandits/algos/linear_bandit/group_robust_dpo_vectorised_gradfix.py[line:1297] - INFO: unique_group_ids: {0, 1, 2}
2024-09-18 22:54:40,843 - /Users/noesis/Projects/Group-robust-preference-optimization-bandits/algos/linear_bandit/group_robust_dpo_vectorised_gradfix.py[line:1523] - INFO: Iteration:  0, train_loss:  17.0769, val_loss:  16.0375, grad_norm: 0.2140, live_grad: 0.0000, reward_err: 0.1380, 0.0045, 0.1075, KL_dist: 2.4862, 0.6791, 2.2141, param: [17.36341819  3.0673597   1.42051931  3.94405701], weights: [0.33304748 0.33306252 0.33389   ], train_wt_loss:  51.2306, val_wt_loss: 48.1125, train_grp_loss: [18.37471039 15.08026749 18.82368425], val_grp_loss: [21.39572511  7.14297233 19.9598959 ], train_hist_grp_loss: [0.16337267 0.16789007 0.41602726], cur_train_grp_loss: [0.16337267 0.16789007 0.41602726], max_reward_err:  0.1380, max_reward_err_index: 0, max_kl_dist:  2.4862, max_kl_dist_index: 0, max_train_grp_loss:  18.8237, max_train_grp_loss_index: 2, max_val_grp_loss:  21.3957, max_val_grp_loss_index: 0, max_cur_train_grp_loss:  0.4160, max_cur_train_grp_loss_index: 2, 
2024-09-18 22:54:45,332 - /Users/noesis/Projects/Group-robust-preference-optimization-bandits/algos/linear_bandit/group_robust_dpo_vectorised_gradfix.py[line:1523] - INFO: Iteration:  100, train_loss:  17.0799, val_loss:  15.9705, grad_norm: 0.0102, live_grad: 0.0000, reward_err: 0.1374, 0.0046, 0.1068, KL_dist: 2.5043, 0.6956, 2.2332, param: [17.48710266  3.22178983  1.44015467  4.08132534], weights: [0.30907076 0.30135751 0.38957173], train_wt_loss:  51.2397, val_wt_loss: 47.9116, train_grp_loss: [18.26288771 15.23920226 18.72411451], val_grp_loss: [21.30278004  7.13053224 19.86187561], train_hist_grp_loss: [14.81985366 12.2925588  37.96763043], cur_train_grp_loss: [0.14611266 0.12189935 0.37450392], max_reward_err:  0.1374, max_reward_err_index: 0, max_kl_dist:  2.5043, max_kl_dist_index: 0, max_train_grp_loss:  18.7241, max_train_grp_loss_index: 2, max_val_grp_loss:  21.3028, max_val_grp_loss_index: 0, max_cur_train_grp_loss:  0.3745, max_cur_train_grp_loss_index: 2, 
2024-09-18 22:54:49,734 - /Users/noesis/Projects/Group-robust-preference-optimization-bandits/algos/linear_bandit/group_robust_dpo_vectorised_gradfix.py[line:1631] - INFO: Iteration:  199, train_loss:  17.0911, val_loss:  15.8915, grad_norm: 0.0255,  live_grad: 0.0000, reward_err: 0.1340, 0.0049, 0.1034, KL_dist: 2.5200, 0.7153, 2.2499, param: [17.6081951   3.40213583  1.48949424  4.24406765], weights: [0.28309396 0.26983119 0.44707485], train_wt_loss:  51.2733, val_wt_loss: 47.6746, train_grp_loss: [18.1360904  15.43956219 18.60739031], val_grp_loss: [21.18816992  7.12499953 19.74173358], train_hist_grp_loss: [29.23550622 24.43727374 74.93022471], cur_train_grp_loss: [0.14509969 0.12349822 0.3721734 ], max_reward_err:  0.1340, max_reward_err_index: 0, max_kl_dist:  2.5200, max_kl_dist_index: 0, max_train_grp_loss:  18.6074, max_train_grp_loss_index: 2, max_val_grp_loss:  21.1882, max_val_grp_loss_index: 0, max_cur_train_grp_loss:  0.3722, max_cur_train_grp_loss_index: 2, 
2024-09-18 22:54:49,958 - /Users/noesis/Projects/Group-robust-preference-optimization-bandits/experiments/run_glb_noisy.py[line:387] - INFO: Policy parameter learned solely on the preference data rdpo: [17.6081951   3.40213583  1.48949424  4.24406765].
2024-09-18 22:54:50,292 - /Users/noesis/Projects/Group-robust-preference-optimization-bandits/experiments/run_glb_noisy.py[line:398] - INFO: Uniform reward: 3.7985, 3.7985, 3.1685
2024-09-18 22:54:50,293 - /Users/noesis/Projects/Group-robust-preference-optimization-bandits/experiments/run_glb_noisy.py[line:399] - INFO: Optimal reward: 3.8318, 3.8318, 3.2963
2024-09-18 22:54:50,293 - /Users/noesis/Projects/Group-robust-preference-optimization-bandits/experiments/run_glb_noisy.py[line:400] - INFO: Policy reward: 3.3183, 3.8130, 2.9554
2024-09-18 22:54:50,294 - /Users/noesis/Projects/Group-robust-preference-optimization-bandits/experiments/run_glb_noisy.py[line:401] - INFO: Reward Error: 0.1340, 0.0049, 0.1034
2024-09-18 22:54:50,970 - /Users/noesis/Projects/Group-robust-preference-optimization-bandits/experiments/run_glb_noisy.py[line:416] - INFO: Optimal reward: 3.8318, 3.8318, 3.2963
Known param reward: [[3.831752300262451, 3.4357662200927734, 3.262315034866333], [3.4357662200927734, 3.831752300262451, 3.0935750007629395], [3.795030355453491, 3.565478563308716, 3.2963407039642334]], Known param reward error: [[0.0, 0.1033433398454684, 0.010322254934685776], [0.1033433398454684, 0.0, 0.061512362164943865], [0.009583590464979884, 0.06949137524768949, 0.0]].
