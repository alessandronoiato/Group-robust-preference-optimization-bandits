2024-09-18 22:56:44,156 - /Users/noesis/Projects/Group-robust-preference-optimization-bandits/experiments/run_glb_noisy.py[line:199] - INFO: Logging to log_rdpo/2024_09_18_22_39_43/swapped_noise0.4_[1,0.4,1]_2026
2024-09-18 22:56:44,158 - /Users/noesis/Projects/Group-robust-preference-optimization-bandits/experiments/run_glb_noisy.py[line:200] - INFO: (IB) Seed: 2026
2024-09-18 22:56:44,159 - /Users/noesis/Projects/Group-robust-preference-optimization-bandits/experiments/run_glb_noisy.py[line:201] - INFO: (IB) Data: 300
2024-09-18 22:56:44,318 - /Users/noesis/Projects/Group-robust-preference-optimization-bandits/experiments/run_glb_noisy.py[line:297] - INFO: MLE reward loss: 0.5431, l2 distance: 9.5009, acc: 0.73.
2024-09-18 22:56:44,319 - /Users/noesis/Projects/Group-robust-preference-optimization-bandits/experiments/run_glb_noisy.py[line:298] - INFO: True reward parameter: [[1.  3.  1.  3. ]
 [3.  1.  3.  1. ]
 [1.5 2.5 1.5 2.5]]
2024-09-18 22:56:44,320 - /Users/noesis/Projects/Group-robust-preference-optimization-bandits/experiments/run_glb_noisy.py[line:299] - INFO: MLE reward parameter: [4.34794473 3.37466145 6.23728494 2.01628827]
2024-09-18 22:56:44,528 - /Users/noesis/Projects/Group-robust-preference-optimization-bandits/experiments/run_glb_noisy.py[line:314] - INFO: Learned oracle reward: 3.5407, 3.8522, 3.1577
2024-09-18 22:56:44,783 - /Users/noesis/Projects/Group-robust-preference-optimization-bandits/algos/linear_bandit/group_robust_dpo_vectorised_gradfix.py[line:1297] - INFO: unique_group_ids: {0, 1, 2}
2024-09-18 22:56:46,087 - /Users/noesis/Projects/Group-robust-preference-optimization-bandits/algos/linear_bandit/group_robust_dpo_vectorised_gradfix.py[line:1523] - INFO: Iteration:  0, train_loss:  18.8425, val_loss:  15.6016, grad_norm: 0.1416, live_grad: 0.0000, reward_err: 0.0886, 0.0037, 0.0478, KL_dist: 1.1731, 0.5919, 0.9352, param: [ 7.63876723  5.13427824 10.09201989  3.12997346], weights: [0.33296584 0.33305651 0.33397765], train_wt_loss:  56.5275, val_wt_loss: 46.8048, train_grp_loss: [19.17071986 17.73060026 20.5994224 ], val_grp_loss: [20.19870194  7.42100474 17.9654247 ], train_hist_grp_loss: [0.14885864 0.17608818 0.4522776 ], cur_train_grp_loss: [0.14885864 0.17608818 0.4522776 ], max_reward_err:  0.0886, max_reward_err_index: 0, max_kl_dist:  1.1731, max_kl_dist_index: 0, max_train_grp_loss:  20.5994, max_train_grp_loss_index: 2, max_val_grp_loss:  20.1987, max_val_grp_loss_index: 0, max_cur_train_grp_loss:  0.4523, max_cur_train_grp_loss_index: 2, 
2024-09-18 22:56:50,590 - /Users/noesis/Projects/Group-robust-preference-optimization-bandits/algos/linear_bandit/group_robust_dpo_vectorised_gradfix.py[line:1523] - INFO: Iteration:  100, train_loss:  18.8496, val_loss:  15.5276, grad_norm: 0.0098, live_grad: 0.0000, reward_err: 0.0863, 0.0044, 0.0452, KL_dist: 1.1500, 0.6075, 0.9133, param: [8.27480045 5.27231138 9.5353279  3.23976266], weights: [0.29699268 0.30218319 0.40082412], train_wt_loss:  56.5487, val_wt_loss: 46.5827, train_grp_loss: [19.02728553 18.04392327 20.29891233], val_grp_loss: [20.06081882  7.47809377 17.84318382], train_hist_grp_loss: [13.99042836 15.72302198 43.97195184], cur_train_grp_loss: [0.13788997 0.15687286 0.43196012], max_reward_err:  0.0863, max_reward_err_index: 0, max_kl_dist:  1.1500, max_kl_dist_index: 0, max_train_grp_loss:  20.2989, max_train_grp_loss_index: 2, max_val_grp_loss:  20.0608, max_val_grp_loss_index: 0, max_cur_train_grp_loss:  0.4320, max_cur_train_grp_loss_index: 2, 
2024-09-18 22:56:54,972 - /Users/noesis/Projects/Group-robust-preference-optimization-bandits/algos/linear_bandit/group_robust_dpo_vectorised_gradfix.py[line:1631] - INFO: Iteration:  199, train_loss:  18.8753, val_loss:  15.4538, grad_norm: 0.0254,  live_grad: 0.0000, reward_err: 0.0819, 0.0058, 0.0412, KL_dist: 1.1479, 0.6286, 0.9128, param: [8.99783529 5.44404875 8.90850291 3.37852734], weights: [0.2604527  0.27063334 0.46891396], train_wt_loss:  56.6258, val_wt_loss: 46.3614, train_grp_loss: [18.86708084 18.44090291 19.96211264], val_grp_loss: [19.90657295  7.57103162 17.70743611], train_hist_grp_loss: [27.58455281 31.41891776 86.38435523], cur_train_grp_loss: [0.13673029 0.16031664 0.42480183], max_reward_err:  0.0819, max_reward_err_index: 0, max_kl_dist:  1.1479, max_kl_dist_index: 0, max_train_grp_loss:  19.9621, max_train_grp_loss_index: 2, max_val_grp_loss:  19.9066, max_val_grp_loss_index: 0, max_cur_train_grp_loss:  0.4248, max_cur_train_grp_loss_index: 2, 
2024-09-18 22:56:55,198 - /Users/noesis/Projects/Group-robust-preference-optimization-bandits/experiments/run_glb_noisy.py[line:387] - INFO: Policy parameter learned solely on the preference data rdpo: [8.99783529 5.44404875 8.90850291 3.37852734].
2024-09-18 22:56:55,535 - /Users/noesis/Projects/Group-robust-preference-optimization-bandits/experiments/run_glb_noisy.py[line:398] - INFO: Uniform reward: 3.8382, 3.8382, 3.1948
2024-09-18 22:56:55,536 - /Users/noesis/Projects/Group-robust-preference-optimization-bandits/experiments/run_glb_noisy.py[line:399] - INFO: Optimal reward: 3.8741, 3.8741, 3.3119
2024-09-18 22:56:55,537 - /Users/noesis/Projects/Group-robust-preference-optimization-bandits/experiments/run_glb_noisy.py[line:400] - INFO: Policy reward: 3.5567, 3.8517, 3.1753
2024-09-18 22:56:55,537 - /Users/noesis/Projects/Group-robust-preference-optimization-bandits/experiments/run_glb_noisy.py[line:401] - INFO: Reward Error: 0.0819, 0.0058, 0.0412
2024-09-18 22:56:56,224 - /Users/noesis/Projects/Group-robust-preference-optimization-bandits/experiments/run_glb_noisy.py[line:416] - INFO: Optimal reward: 3.8741, 3.8741, 3.3119
Known param reward: [[3.8741025924682617, 3.481130361557007, 3.279806137084961], [3.481130361557007, 3.8741025924682617, 3.1205224990844727], [3.8313021659851074, 3.6054656505584717, 3.3118550777435303]], Known param reward error: [[0.0, 0.10143568001406103, 0.009677035953036107], [0.10143568001406103, 0.0, 0.057772026301772375], [0.011047829906818591, 0.06934172121101123, 0.0]].
