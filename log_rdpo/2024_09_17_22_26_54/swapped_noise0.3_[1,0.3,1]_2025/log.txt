2024-09-17 22:31:27,398 - /Users/noesis/Projects/Group-robust-preference-optimization-bandits/experiments/run_glb_noisy.py[line:198] - INFO: Logging to log_rdpo/2024_09_17_22_26_54/swapped_noise0.3_[1,0.3,1]_2025
2024-09-17 22:31:27,400 - /Users/noesis/Projects/Group-robust-preference-optimization-bandits/experiments/run_glb_noisy.py[line:199] - INFO: (IB) Seed: 2025
2024-09-17 22:31:27,401 - /Users/noesis/Projects/Group-robust-preference-optimization-bandits/experiments/run_glb_noisy.py[line:200] - INFO: (IB) Data: 300
2024-09-17 22:31:27,564 - /Users/noesis/Projects/Group-robust-preference-optimization-bandits/experiments/run_glb_noisy.py[line:296] - INFO: MLE reward loss: 0.4481, l2 distance: 16.8481, acc: 0.80.
2024-09-17 22:31:27,565 - /Users/noesis/Projects/Group-robust-preference-optimization-bandits/experiments/run_glb_noisy.py[line:297] - INFO: True reward parameter: [[1.  3.  1.  3. ]
 [3.  1.  3.  1. ]
 [1.5 2.5 1.5 2.5]]
2024-09-17 22:31:27,566 - /Users/noesis/Projects/Group-robust-preference-optimization-bandits/experiments/run_glb_noisy.py[line:298] - INFO: MLE reward parameter: [8.49886496 5.08483761 7.57654104 4.57522525]
2024-09-17 22:31:27,778 - /Users/noesis/Projects/Group-robust-preference-optimization-bandits/experiments/run_glb_noisy.py[line:313] - INFO: Learned oracle reward: 3.5973, 3.8110, 3.1540
2024-09-17 22:31:28,013 - /Users/noesis/Projects/Group-robust-preference-optimization-bandits/algos/linear_bandit/group_robust_dpo_vectorised_gradfix.py[line:1297] - INFO: unique_group_ids: {0, 1, 2}
2024-09-17 22:31:29,213 - /Users/noesis/Projects/Group-robust-preference-optimization-bandits/algos/linear_bandit/group_robust_dpo_vectorised_gradfix.py[line:1523] - INFO: Iteration:  0, train_loss:  16.0122, val_loss:  19.0598, grad_norm: 0.2668, live_grad: 0.0000, reward_err: 0.0964, 0.0009, 0.0588, KL_dist: 1.5061, 0.8339, 1.2306, param: [12.16592446  4.58327922  8.83719604  3.76466993], weights: [0.33345852 0.33315571 0.33338578], train_wt_loss:  48.0367, val_wt_loss: 57.1793, train_grp_loss: [20.67831228 10.86876189 17.47253162], val_grp_loss: [21.19868804 17.88549177 18.20140225], train_hist_grp_loss: [0.24876977 0.15792028 0.22695437], cur_train_grp_loss: [0.24876977 0.15792028 0.22695437], max_reward_err:  0.0964, max_reward_err_index: 0, max_kl_dist:  1.5061, max_kl_dist_index: 0, max_train_grp_loss:  20.6783, max_train_grp_loss_index: 0, max_val_grp_loss:  21.1987, max_val_grp_loss_index: 0, max_cur_train_grp_loss:  0.2488, max_cur_train_grp_loss_index: 0, 
2024-09-17 22:31:33,558 - /Users/noesis/Projects/Group-robust-preference-optimization-bandits/algos/linear_bandit/group_robust_dpo_vectorised_gradfix.py[line:1631] - INFO: Iteration:  99, train_loss:  16.0185, val_loss:  19.0437, grad_norm: 0.0105,  live_grad: 0.0000, reward_err: 0.0953, 0.0018, 0.0582, KL_dist: 1.5198, 0.8513, 1.2498, param: [12.40385051  4.84706407  8.6123418   3.99491936], weights: [0.35203733 0.31101253 0.33695014], train_wt_loss:  48.0556, val_wt_loss: 57.1310, train_grp_loss: [20.44831557 11.183825   17.34963239], val_grp_loss: [21.02099844 18.11693832 18.09229169], train_hist_grp_loss: [22.37820291  9.9877993  17.99797645], cur_train_grp_loss: [0.2222897  0.10072471 0.17887517], max_reward_err:  0.0953, max_reward_err_index: 0, max_kl_dist:  1.5198, max_kl_dist_index: 0, max_train_grp_loss:  20.4483, max_train_grp_loss_index: 0, max_val_grp_loss:  21.0210, max_val_grp_loss_index: 0, max_cur_train_grp_loss:  0.2223, max_cur_train_grp_loss_index: 0, 
2024-09-17 22:31:33,782 - /Users/noesis/Projects/Group-robust-preference-optimization-bandits/experiments/run_glb_noisy.py[line:386] - INFO: Policy parameter learned solely on the preference data rdpo: [12.40385051  4.84706407  8.6123418   3.99491936].
2024-09-17 22:31:34,109 - /Users/noesis/Projects/Group-robust-preference-optimization-bandits/experiments/run_glb_noisy.py[line:397] - INFO: Uniform reward: 3.8189, 3.8189, 3.1471
2024-09-17 22:31:34,110 - /Users/noesis/Projects/Group-robust-preference-optimization-bandits/experiments/run_glb_noisy.py[line:398] - INFO: Optimal reward: 3.8509, 3.8509, 3.2572
2024-09-17 22:31:34,110 - /Users/noesis/Projects/Group-robust-preference-optimization-bandits/experiments/run_glb_noisy.py[line:399] - INFO: Policy reward: 3.4839, 3.8440, 3.0675
2024-09-17 22:31:34,111 - /Users/noesis/Projects/Group-robust-preference-optimization-bandits/experiments/run_glb_noisy.py[line:400] - INFO: Reward Error: 0.0953, 0.0018, 0.0582
2024-09-17 22:31:34,792 - /Users/noesis/Projects/Group-robust-preference-optimization-bandits/experiments/run_glb_noisy.py[line:415] - INFO: Optimal reward: 3.8509, 3.8509, 3.2572
Known param reward: [[3.850886821746826, 3.4759232997894287, 3.2200934886932373], [3.4759232997894287, 3.850886821746826, 3.068084716796875], [3.8119678497314453, 3.597700595855713, 3.257154703140259]], Known param reward error: [[0.0, 0.09737069389832334, 0.011378401649541042], [0.09737069389832334, 0.0, 0.058047591709751864], [0.010106495936363709, 0.06574751157611633, 0.0]].
