2024-09-18 16:01:36,330 - /Users/noesis/Projects/Group-robust-preference-optimization-bandits/experiments/run_glb_noisy.py[line:199] - INFO: Logging to log_rdpo/2024_09_18_15_16_04/swapped_noise0.4_[1,0.4,1]_2025
2024-09-18 16:01:36,332 - /Users/noesis/Projects/Group-robust-preference-optimization-bandits/experiments/run_glb_noisy.py[line:200] - INFO: (IB) Seed: 2025
2024-09-18 16:01:36,333 - /Users/noesis/Projects/Group-robust-preference-optimization-bandits/experiments/run_glb_noisy.py[line:201] - INFO: (IB) Data: 300
2024-09-18 16:01:36,493 - /Users/noesis/Projects/Group-robust-preference-optimization-bandits/experiments/run_glb_noisy.py[line:297] - INFO: MLE reward loss: 0.5206, l2 distance: 11.9345, acc: 0.78.
2024-09-18 16:01:36,494 - /Users/noesis/Projects/Group-robust-preference-optimization-bandits/experiments/run_glb_noisy.py[line:298] - INFO: True reward parameter: [[1.  3.  1.  3. ]
 [3.  1.  3.  1. ]
 [1.5 2.5 1.5 2.5]]
2024-09-18 16:01:36,495 - /Users/noesis/Projects/Group-robust-preference-optimization-bandits/experiments/run_glb_noisy.py[line:299] - INFO: MLE reward parameter: [5.56603535 3.96577774 6.74359709 3.98547307]
2024-09-18 16:01:36,698 - /Users/noesis/Projects/Group-robust-preference-optimization-bandits/experiments/run_glb_noisy.py[line:314] - INFO: Learned oracle reward: 3.5970, 3.8011, 3.1521
2024-09-18 16:01:36,946 - /Users/noesis/Projects/Group-robust-preference-optimization-bandits/algos/linear_bandit/group_robust_dpo_vectorised_gradfix.py[line:1297] - INFO: unique_group_ids: {0, 1, 2}
2024-09-18 16:01:38,118 - /Users/noesis/Projects/Group-robust-preference-optimization-bandits/algos/linear_bandit/group_robust_dpo_vectorised_gradfix.py[line:1523] - INFO: Iteration:  0, train_loss:  18.4566, val_loss:  18.0266, grad_norm: 0.1552, live_grad: 0.0000, reward_err: 0.0712, 0.0088, 0.0367, KL_dist: 1.0797, 0.6442, 0.8807, param: [7.62941557 4.94339647 9.69093979 4.87302714], weights: [0.33340237 0.33323707 0.33336056], train_wt_loss:  55.3698, val_wt_loss: 54.0797, train_grp_loss: [19.6571437  17.59859113 18.2997975 ], val_grp_loss: [20.22603991 15.75544147 18.20134083], train_hist_grp_loss: [0.22682293 0.17722933 0.21428275], cur_train_grp_loss: [0.22682293 0.17722933 0.21428275], max_reward_err:  0.0712, max_reward_err_index: 0, max_kl_dist:  1.0797, max_kl_dist_index: 0, max_train_grp_loss:  19.6571, max_train_grp_loss_index: 0, max_val_grp_loss:  20.2260, max_val_grp_loss_index: 0, max_cur_train_grp_loss:  0.2268, max_cur_train_grp_loss_index: 0, 
2024-09-18 16:01:42,562 - /Users/noesis/Projects/Group-robust-preference-optimization-bandits/algos/linear_bandit/group_robust_dpo_vectorised_gradfix.py[line:1631] - INFO: Iteration:  99, train_loss:  18.4575, val_loss:  18.0256, grad_norm: 0.0047,  live_grad: 0.0000, reward_err: 0.0710, 0.0089, 0.0365, KL_dist: 1.0849, 0.6563, 0.8870, param: [7.66631034 5.02850567 9.71131245 4.96693698], weights: [0.3421438  0.32410793 0.33374826], train_wt_loss:  55.3726, val_wt_loss: 54.0767, train_grp_loss: [19.58590459 17.71915158 18.23231235], val_grp_loss: [20.15991058 15.87544632 18.1417322 ], train_hist_grp_loss: [21.34164764 15.92619361 18.85723602], cur_train_grp_loss: [0.21289807 0.15962085 0.18796897], max_reward_err:  0.0710, max_reward_err_index: 0, max_kl_dist:  1.0849, max_kl_dist_index: 0, max_train_grp_loss:  19.5859, max_train_grp_loss_index: 0, max_val_grp_loss:  20.1599, max_val_grp_loss_index: 0, max_cur_train_grp_loss:  0.2129, max_cur_train_grp_loss_index: 0, 
2024-09-18 16:01:42,780 - /Users/noesis/Projects/Group-robust-preference-optimization-bandits/experiments/run_glb_noisy.py[line:387] - INFO: Policy parameter learned solely on the preference data rdpo: [7.66631034 5.02850567 9.71131245 4.96693698].
2024-09-18 16:01:43,102 - /Users/noesis/Projects/Group-robust-preference-optimization-bandits/experiments/run_glb_noisy.py[line:398] - INFO: Uniform reward: 3.8189, 3.8189, 3.1471
2024-09-18 16:01:43,103 - /Users/noesis/Projects/Group-robust-preference-optimization-bandits/experiments/run_glb_noisy.py[line:399] - INFO: Optimal reward: 3.8509, 3.8509, 3.2572
2024-09-18 16:01:43,104 - /Users/noesis/Projects/Group-robust-preference-optimization-bandits/experiments/run_glb_noisy.py[line:400] - INFO: Policy reward: 3.5775, 3.8164, 3.1383
2024-09-18 16:01:43,104 - /Users/noesis/Projects/Group-robust-preference-optimization-bandits/experiments/run_glb_noisy.py[line:401] - INFO: Reward Error: 0.0710, 0.0089, 0.0365
2024-09-18 16:01:43,781 - /Users/noesis/Projects/Group-robust-preference-optimization-bandits/experiments/run_glb_noisy.py[line:416] - INFO: Optimal reward: 3.8509, 3.8509, 3.2572
Known param reward: [[3.850886821746826, 3.4759232997894287, 3.2200934886932373], [3.4759232997894287, 3.850886821746826, 3.068084716796875], [3.8119678497314453, 3.597700595855713, 3.257154703140259]], Known param reward error: [[0.0, 0.09737069389832334, 0.011378401649541042], [0.09737069389832334, 0.0, 0.058047591709751864], [0.010106495936363709, 0.06574751157611633, 0.0]].
