2024-09-18 20:14:12,292 - /Users/noesis/Projects/Group-robust-preference-optimization-bandits/experiments/run_glb_noisy.py[line:199] - INFO: Logging to log_rdpo/2024_09_18_19_49_22/swapped_noise0.8_[1,0.8,1]_2027
2024-09-18 20:14:12,294 - /Users/noesis/Projects/Group-robust-preference-optimization-bandits/experiments/run_glb_noisy.py[line:200] - INFO: (IB) Seed: 2027
2024-09-18 20:14:12,294 - /Users/noesis/Projects/Group-robust-preference-optimization-bandits/experiments/run_glb_noisy.py[line:201] - INFO: (IB) Data: 300
2024-09-18 20:14:12,464 - /Users/noesis/Projects/Group-robust-preference-optimization-bandits/experiments/run_glb_noisy.py[line:297] - INFO: MLE reward loss: 0.3814, l2 distance: 23.7630, acc: 0.85.
2024-09-18 20:14:12,465 - /Users/noesis/Projects/Group-robust-preference-optimization-bandits/experiments/run_glb_noisy.py[line:298] - INFO: True reward parameter: [[1.  3.  1.  3. ]
 [3.  1.  3.  1. ]
 [1.5 2.5 1.5 2.5]]
2024-09-18 20:14:12,466 - /Users/noesis/Projects/Group-robust-preference-optimization-bandits/experiments/run_glb_noisy.py[line:299] - INFO: MLE reward parameter: [ 8.88080729  4.95567706 12.33493647  6.36297512]
2024-09-18 20:14:12,679 - /Users/noesis/Projects/Group-robust-preference-optimization-bandits/experiments/run_glb_noisy.py[line:314] - INFO: Learned oracle reward: 3.5399, 3.8381, 3.2082
2024-09-18 20:14:12,970 - /Users/noesis/Projects/Group-robust-preference-optimization-bandits/algos/linear_bandit/group_robust_dpo_vectorised_gradfix.py[line:1297] - INFO: unique_group_ids: {0, 1, 2}
2024-09-18 20:14:14,300 - /Users/noesis/Projects/Group-robust-preference-optimization-bandits/algos/linear_bandit/group_robust_dpo_vectorised_gradfix.py[line:1523] - INFO: Iteration:  0, train_loss:  14.2959, val_loss:  16.3214, grad_norm: 0.3531, live_grad: 0.0000, reward_err: 0.1133, 0.0053, 0.0759, KL_dist: 2.2517, 0.9477, 1.9180, param: [ 6.41031457  3.86425793 16.08032988  5.24957212], weights: [0.33312974 0.33310941 0.33376085], train_wt_loss:  42.8877, val_wt_loss: 48.9643, train_grp_loss: [18.72210986  9.84492143 13.34113725], val_grp_loss: [20.58514684 10.25131122 18.12831726], train_hist_grp_loss: [0.18639683 0.18029242 0.37566681], cur_train_grp_loss: [0.18639683 0.18029242 0.37566681], max_reward_err:  0.1133, max_reward_err_index: 0, max_kl_dist:  2.2517, max_kl_dist_index: 0, max_train_grp_loss:  18.7221, max_train_grp_loss_index: 0, max_val_grp_loss:  20.5851, max_val_grp_loss_index: 0, max_cur_train_grp_loss:  0.3757, max_cur_train_grp_loss_index: 2, 
2024-09-18 20:14:18,763 - /Users/noesis/Projects/Group-robust-preference-optimization-bandits/algos/linear_bandit/group_robust_dpo_vectorised_gradfix.py[line:1631] - INFO: Iteration:  99, train_loss:  14.2988, val_loss:  16.3367, grad_norm: 0.0086,  live_grad: 0.0000, reward_err: 0.1126, 0.0054, 0.0754, KL_dist: 2.2930, 0.9718, 1.9581, param: [ 6.40245397  3.98112356 16.30182932  5.3769941 ], weights: [0.33199877 0.31296128 0.35503995], train_wt_loss:  42.8965, val_wt_loss: 49.0102, train_grp_loss: [18.63707229 10.02228569 13.20782404], val_grp_loss: [20.53142603 10.42755643 18.05289937], train_hist_grp_loss: [14.86372717  8.95854812 21.57363076], cur_train_grp_loss: [0.14792019 0.08946775 0.21305146], max_reward_err:  0.1126, max_reward_err_index: 0, max_kl_dist:  2.2930, max_kl_dist_index: 0, max_train_grp_loss:  18.6371, max_train_grp_loss_index: 0, max_val_grp_loss:  20.5314, max_val_grp_loss_index: 0, max_cur_train_grp_loss:  0.2131, max_cur_train_grp_loss_index: 2, 
2024-09-18 20:14:18,993 - /Users/noesis/Projects/Group-robust-preference-optimization-bandits/experiments/run_glb_noisy.py[line:387] - INFO: Policy parameter learned solely on the preference data rdpo: [ 6.40245397  3.98112356 16.30182932  5.3769941 ].
2024-09-18 20:14:19,327 - /Users/noesis/Projects/Group-robust-preference-optimization-bandits/experiments/run_glb_noisy.py[line:398] - INFO: Uniform reward: 3.8205, 3.8205, 3.2153
2024-09-18 20:14:19,328 - /Users/noesis/Projects/Group-robust-preference-optimization-bandits/experiments/run_glb_noisy.py[line:399] - INFO: Optimal reward: 3.8664, 3.8664, 3.3644
2024-09-18 20:14:19,329 - /Users/noesis/Projects/Group-robust-preference-optimization-bandits/experiments/run_glb_noisy.py[line:400] - INFO: Policy reward: 3.4311, 3.8456, 3.1107
2024-09-18 20:14:19,329 - /Users/noesis/Projects/Group-robust-preference-optimization-bandits/experiments/run_glb_noisy.py[line:401] - INFO: Reward Error: 0.1126, 0.0054, 0.0754
2024-09-18 20:14:20,091 - /Users/noesis/Projects/Group-robust-preference-optimization-bandits/experiments/run_glb_noisy.py[line:416] - INFO: Optimal reward: 3.8664, 3.8664, 3.3644
Known param reward: [[3.866352081298828, 3.466999053955078, 3.324810028076172], [3.466999053955078, 3.866352081298828, 3.1610913276672363], [3.8258588314056396, 3.5992729663848877, 3.364398956298828]], Known param reward error: [[0.0, 0.10328935879258955, 0.011767013584562513], [0.10328935879258955, 0.0, 0.06042910822182941], [0.010473244298947946, 0.06907780494326327, 0.0]].
