2024-09-18 20:12:49,795 - /Users/noesis/Projects/Group-robust-preference-optimization-bandits/experiments/run_glb_noisy.py[line:199] - INFO: Logging to log_rdpo/2024_09_18_19_49_22/swapped_noise0.8_[1,0.8,1]_2023
2024-09-18 20:12:49,797 - /Users/noesis/Projects/Group-robust-preference-optimization-bandits/experiments/run_glb_noisy.py[line:200] - INFO: (IB) Seed: 2023
2024-09-18 20:12:49,797 - /Users/noesis/Projects/Group-robust-preference-optimization-bandits/experiments/run_glb_noisy.py[line:201] - INFO: (IB) Data: 300
2024-09-18 20:12:49,964 - /Users/noesis/Projects/Group-robust-preference-optimization-bandits/experiments/run_glb_noisy.py[line:297] - INFO: MLE reward loss: 0.3816, l2 distance: 25.2288, acc: 0.84.
2024-09-18 20:12:49,965 - /Users/noesis/Projects/Group-robust-preference-optimization-bandits/experiments/run_glb_noisy.py[line:298] - INFO: True reward parameter: [[1.  3.  1.  3. ]
 [3.  1.  3.  1. ]
 [1.5 2.5 1.5 2.5]]
2024-09-18 20:12:49,966 - /Users/noesis/Projects/Group-robust-preference-optimization-bandits/experiments/run_glb_noisy.py[line:299] - INFO: MLE reward parameter: [11.8054666   5.72924637 11.05018189  5.65805765]
2024-09-18 20:12:50,183 - /Users/noesis/Projects/Group-robust-preference-optimization-bandits/experiments/run_glb_noisy.py[line:314] - INFO: Learned oracle reward: 3.5522, 3.8492, 3.1589
2024-09-18 20:12:50,421 - /Users/noesis/Projects/Group-robust-preference-optimization-bandits/algos/linear_bandit/group_robust_dpo_vectorised_gradfix.py[line:1297] - INFO: unique_group_ids: {0, 1, 2}
2024-09-18 20:12:51,813 - /Users/noesis/Projects/Group-robust-preference-optimization-bandits/algos/linear_bandit/group_robust_dpo_vectorised_gradfix.py[line:1523] - INFO: Iteration:  0, train_loss:  14.4250, val_loss:  15.8549, grad_norm: 0.2919, live_grad: 0.0000, reward_err: 0.1000, 0.0004, 0.0611, KL_dist: 1.9106, 1.0770, 1.5817, param: [13.89256896  4.94704364 10.25894755  4.45657391], weights: [0.33306774 0.3330146  0.33391766], train_wt_loss:  43.2749, val_wt_loss: 47.5646, train_grp_loss: [19.47026465  8.41713003 15.58269251], val_grp_loss: [21.61434014  9.10838666 17.13888974], train_hist_grp_loss: [0.17320512 0.15724988 0.42805963], cur_train_grp_loss: [0.17320512 0.15724988 0.42805963], max_reward_err:  0.1000, max_reward_err_index: 0, max_kl_dist:  1.9106, max_kl_dist_index: 0, max_train_grp_loss:  19.4703, max_train_grp_loss_index: 0, max_val_grp_loss:  21.6143, max_val_grp_loss_index: 0, max_cur_train_grp_loss:  0.4281, max_cur_train_grp_loss_index: 2, 
2024-09-18 20:12:56,546 - /Users/noesis/Projects/Group-robust-preference-optimization-bandits/algos/linear_bandit/group_robust_dpo_vectorised_gradfix.py[line:1631] - INFO: Iteration:  99, train_loss:  14.4320, val_loss:  15.8304, grad_norm: 0.0137,  live_grad: 0.0000, reward_err: 0.0941, 0.0008, 0.0554, KL_dist: 1.9220, 1.1106, 1.5938, param: [13.85181967  5.19403351 10.57267887  4.66690849], weights: [0.323161   0.29929746 0.37754154], train_wt_loss:  43.2961, val_wt_loss: 47.4911, train_grp_loss: [19.30939826  8.69371393 15.38903331], val_grp_loss: [21.44199266  9.3822233  16.9605342 ], train_hist_grp_loss: [14.94076848  7.26949587 30.49376449], cur_train_grp_loss: [0.14854684 0.07303036 0.30178594], max_reward_err:  0.0941, max_reward_err_index: 0, max_kl_dist:  1.9220, max_kl_dist_index: 0, max_train_grp_loss:  19.3094, max_train_grp_loss_index: 0, max_val_grp_loss:  21.4420, max_val_grp_loss_index: 0, max_cur_train_grp_loss:  0.3018, max_cur_train_grp_loss_index: 2, 
2024-09-18 20:12:56,779 - /Users/noesis/Projects/Group-robust-preference-optimization-bandits/experiments/run_glb_noisy.py[line:387] - INFO: Policy parameter learned solely on the preference data rdpo: [13.85181967  5.19403351 10.57267887  4.66690849].
2024-09-18 20:12:57,121 - /Users/noesis/Projects/Group-robust-preference-optimization-bandits/experiments/run_glb_noisy.py[line:398] - INFO: Uniform reward: 3.8248, 3.8248, 3.1753
2024-09-18 20:12:57,121 - /Users/noesis/Projects/Group-robust-preference-optimization-bandits/experiments/run_glb_noisy.py[line:399] - INFO: Optimal reward: 3.8634, 3.8634, 3.3001
2024-09-18 20:12:57,122 - /Users/noesis/Projects/Group-robust-preference-optimization-bandits/experiments/run_glb_noisy.py[line:400] - INFO: Policy reward: 3.4999, 3.8602, 3.1172
2024-09-18 20:12:57,122 - /Users/noesis/Projects/Group-robust-preference-optimization-bandits/experiments/run_glb_noisy.py[line:401] - INFO: Reward Error: 0.0941, 0.0008, 0.0554
2024-09-18 20:12:57,822 - /Users/noesis/Projects/Group-robust-preference-optimization-bandits/experiments/run_glb_noisy.py[line:416] - INFO: Optimal reward: 3.8634, 3.8634, 3.3001
Known param reward: [[3.8633759021759033, 3.482351064682007, 3.2718944549560547], [3.482351064682007, 3.8633759021759033, 3.1088309288024902], [3.82757568359375, 3.600954294204712, 3.3000659942626953]], Known param reward error: [[0.0, 0.09862484188486509, 0.008536659374575551], [0.09862484188486509, 0.0, 0.05794886095995515], [0.009266563619136872, 0.06792546586610745, 0.0]].
